<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Vademecum Web per AttivitÃ </title>
<style>
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 0;
    display: flex;
    min-height: 100vh;
  }
  nav {
    width: 250px;
    background: #004880;
    color: white;
    padding: 1em;
    box-sizing: border-box;
  }
  nav h2 {
    font-size: 1.5em;
    margin-top: 0;
  }
  nav ul {
    list-style: none;
    padding-left: 0;
  }
  nav ul li {
    margin: 0.5em 0;
  }
  nav ul li a {
    color: white;
    text-decoration: none;
    cursor: pointer;
  }
  nav ul li a:hover {
    text-decoration: underline;
  }

  main {
    flex-grow: 1;
    padding: 1em 2em;
    overflow-y: auto;
    max-height: 100vh;
  }

  /* Sticky search box */
  #searchBox {
    position: sticky;
    top: 0;
    background: white;
    z-index: 10;
    border-bottom: 1px solid #ccc;
    padding: 0.5em 0.75em;
    font-size: 1em;
    margin-bottom: 1.5em;
  }

  details {
    margin-bottom: 1.5em;
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 0.5em 1em;
    background: #f9f9f9;
  }
  details[open] {
    box-shadow: 0 0 5px rgba(0, 72, 128, 0.5);
  }
  details summary {
    font-weight: 600;
    cursor: pointer;
    outline: none;
  }

  .section-content {
    margin-top: 0.75em;
    white-space: pre-wrap;
  }

  button.copy-btn {
    background-color: #0078d7;
    color: white;
    border: none;
    padding: 0.3em 0.6em;
    border-radius: 3px;
    cursor: pointer;
    float: right;
    font-size: 0.9em;
  }
  button.copy-btn:hover {
    background-color: #005a9e;
  }

  /* Highlight for matched text */
  .highlight {
    background-color: yellow;
    font-weight: bold;
    color: black;
  }
</style>
</head>
<body>

<nav>
  <h2>Menu</h2>
  <ul id="menuList">
    <li><a href="#proc1" onclick="openSection(event, 'proc1')">1. Verifica PC lento</a></li>
    <li><a href="#proc2" onclick="openSection(event, 'proc2')">2. Problema connessione rete</a></li>
    <li><a href="#proc3" onclick="openSection(event, 'proc3')">3. Problema stampante</a></li>
    <li><a href="#proc4" onclick="openSection(event, 'proc4')">4. Aggiornamento software/driver</a></li>
  </ul>
</nav>

<main>
  <input type="text" id="searchBox" placeholder="Cerca in tutto il vademecum..." oninput="searchAll()" aria-label="Cerca nel vademecum" autocomplete="off" />

  <details id="proc1" class="section">
    <summary>1. Procedura da remoto: Verifica e risoluzione PC lento
      <button class="copy-btn" onclick="copySection('proc1')">Copia</button>
    </summary>
    <div class="section-content">
Obiettivo: Identificare cause di rallentamento e risolvere problemi prestazionali.

Passi:
1. â–¶ï¸ Connessione remota
   Accedi al PC tramite software remoto (es. AnyDesk, TeamViewer, Remote Desktop).

2. ğŸ” Verifica carico risorse
   Apri Task Manager (Ctrl + Shift + Esc) â†’ scheda Prestazioni
   Controlla CPU, RAM, disco e rete per picchi o utilizzi anomali.

3. ğŸ› ï¸ Identifica processi pesanti
   Task Manager â†’ scheda Processi
   Ordina per CPU o memoria per vedere processi che consumano risorse.

4. âš™ï¸ Verifica servizi e processi anomali
   Task Manager â†’ scheda Servizi
   Riavvia servizi bloccati o sospetti (clic destro > Riavvia).

5. âš™ï¸ Controlla avvio automatico
   Task Manager â†’ scheda Avvio
   Disabilita programmi non necessari allâ€™avvio.

6. ğŸ“ Controlla spazio disco
   Apri â€œQuesto PCâ€ â†’ verifica spazio disponibile su disco C:
   Se poco spazio, pulisci con â€œPulizia discoâ€ o elimina file temporanei.

7. ğŸ› ï¸ Esegui scansione malware
   Avvia scansione antivirus aggiornata.

8. âš™ï¸ Aggiorna Windows e driver
   Controlla aggiornamenti Windows (Impostazioni > Windows Update)
   Aggiorna driver (gestione dispositivi o software del produttore).

9. ğŸ”„ Riavvio finale
   Riavvia il PC per applicare eventuali modifiche.

10. âœ”ï¸ Verifica finale
    Controlla se il PC ha migliorato la velocitÃ  e comunica con lâ€™utente.
    </div>
  </details>

  <details id="proc2" class="section">
    <summary>2. Procedura da remoto: Problema connessione internet / rete
      <button class="copy-btn" onclick="copySection('proc2')">Copia</button>
    </summary>
    <div class="section-content">
Obiettivo: Diagnosticare e risolvere problemi di connettivitÃ .

Passi:
1. â–¶ï¸ Connessione remota

2. ğŸŒ Verifica stato rete
   Win + R â†’ cmd â†’ esegui ipconfig /all
   Controlla indirizzo IP, gateway, DNS.

3. ğŸ” Ping test
   Esegui ping 8.8.8.8 â†’ verifica perdita pacchetti.
   Esegui ping google.com â†’ verifica risoluzione DNS.

4. ğŸŒ Verifica gateway e rete locale
   Esegui ping &lt;indirizzo gateway&gt; (es. 192.168.1.1).

5. ğŸ”„ Reset stack TCP/IP e DNS
   CMD (admin):
   netsh int ip reset
   ipconfig /flushdns
   ipconfig /release
   ipconfig /renew

6. âš™ï¸ Verifica configurazione proxy/VPN
   Controlla impostazioni proxy e stato VPN.

7. ğŸ›‘ Disabilita temporaneamente firewall/antivirus
   Per testare eventuali blocchi.

8. ğŸ”Œ Verifica cavi e dispositivi
   Chiedi allâ€™utente di controllare i cavi fisici.

9. ğŸ”„ Riavvia scheda di rete
   Pannello di controllo > Rete e Internet > Centro connessioni di rete > Modifica impostazioni scheda
   Disabilita e riabilita la scheda di rete.

10. ğŸ“ Segnala se necessario a livello superiore
    </div>
  </details>

  <details id="proc3" class="section">
    <summary>3. Procedura da remoto: Problema stampante
      <button class="copy-btn" onclick="copySection('proc3')">Copia</button>
    </summary>
    <div class="section-content">
Obiettivo: Risolvere problemi di stampa o riconoscimento stampante.

Passi:
1. â–¶ï¸ Connessione remota

2. ğŸ–¨ï¸ Verifica stato stampante
   Controlla che la stampante sia accesa e collegata (USB o rete).
   Pannello di controllo > Dispositivi e stampanti.

3. ğŸ—‘ï¸ Controlla code di stampa
   Elimina eventuali lavori bloccati.

4. ğŸ”„ Riavvia spooler di stampa
   CMD (admin):
   net stop spooler
   net start spooler

5. âš™ï¸ Verifica driver stampante
   Aggiorna o reinstalla driver se necessario.

6. ğŸ–¨ï¸ Test di stampa
   Esegui pagina di prova.

7. ğŸŒ Verifica configurazione rete (stampanti di rete)
   Ping allâ€™indirizzo IP stampante.

8. ğŸ” Controlla permessi di stampa e condivisione

9. ğŸ”„ Riavvia PC e stampante
    </div>
  </details>

  <details id="proc4" class="section">
    <summary>4. Procedura da remoto: Aggiornamento software o driver
      <button class="copy-btn" onclick="copySection('proc4')">Copia</button>
    </summary>
    <div class="section-content">
Obiettivo: Aggiornare software o driver per migliorare stabilitÃ  o sicurezza.

Passi:
1. â–¶ï¸ Connessione remota

2. ğŸ“‹ Verifica versione corrente

3. ğŸ“ Backup dati/configurazioni (se necessario)

4. ğŸŒ Scarica aggiornamenti ufficiali

5. âš™ï¸ Installa aggiornamenti

6. âœ”ï¸ Verifica esito installazione

7. ğŸ”„ Riavvia sistema se richiesto

8. ğŸ§ª Test funzionalitÃ 
    </div>
  </details>
</main>

<script>
// Apri solo la sezione cliccata, chiudi le altre
function openSection(event, id) {
  event.preventDefault();
  document.querySelectorAll('details').forEach(det => {
    det.open = (det.id === id);
  });
  const el = document.getElementById(id);
  if(el) el.scrollIntoView({behavior:'smooth', block:'start'});
}

// Rimuove evidenziazioni precedenti
function removeHighlights(element) {
  const highlights = element.querySelectorAll('span.highlight');
  highlights.forEach(span => {
    span.replaceWith(document.createTextNode(span.textContent));
  });
}

// Evidenzia tutte le occorrenze del testo cercato
function highlightText(element, text) {
  const walker = document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null, false);
  let node;
  const regex = new RegExp(text.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&'), 'gi');

  while(node = walker.nextNode()) {
    if(node.textContent.toLowerCase().includes(text)) {
      const frag = document.createDocumentFragment();
      let lastIndex = 0;
      let match;
      const originalText = node.textContent;

      while((match = regex.exec(originalText)) !== null) {
        if(match.index > lastIndex) {
          frag.appendChild(document.createTextNode(originalText.substring(lastIndex, match.index)));
        }
        const span = document.createElement('span');
        span.className = 'highlight';
        span.textContent = match[0];
        frag.appendChild(span);
        lastIndex = match.index + match[0].length;
      }

      if(lastIndex < originalText.length) {
        frag.appendChild(document.createTextNode(originalText.substring(lastIndex)));
      }

      node.parentNode.replaceChild(frag, node);
    }
  }
}

// Funzione di ricerca e filtro
function searchAll() {
  const query = document.getElementById('searchBox').value.trim().toLowerCase();
  const sections = document.querySelectorAll('details.section');

  if(!query) {
    sections.forEach(section => {
      section.style.display = '';
      removeHighlights(section);
      section.open = false;
    });
    return;
  }

  sections.forEach(section => {
    removeHighlights(section);
    const text = section.textContent.toLowerCase();
    if(text.includes(query)) {
      section.style.display = '';
      section.open = true;
      highlightText(section, query);
    } else {
      section.style.display = 'none';
      section.open = false;
    }
  });
}

// Copia testo della sezione negli appunti
function copySection(id) {
  const section = document.getElementById(id);
  if(!section) return;
  const text = section.textContent.trim();
  navigator.clipboard.writeText(text).then(() => {
    alert("Testo copiato negli appunti!");
  }).catch(() => {
    alert("Impossibile copiare il testo.");
  });
}
</script>

</body>
</html>
